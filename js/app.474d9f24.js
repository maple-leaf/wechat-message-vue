(function(e){function t(t){for(var a,r,o=t[0],c=t[1],l=t[2],m=0,f=[];m<o.length;m++)r=o[m],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&f.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],a=!0,o=1;o<s.length;o++){var c=s[o];0!==n[c]&&(a=!1)}a&&(i.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},i=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;i.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"0006":function(e,t,s){},"0115":function(e,t,s){"use strict";var a=s("0006"),n=s.n(a);n.a},"034f":function(e,t,s){"use strict";var a=s("64a9"),n=s.n(a);n.a},"0481":function(e,t,s){"use strict";var a=s("461e"),n=s.n(a);n.a},"1e20":function(e,t,s){},"384a":function(e,t,s){},"461e":function(e,t,s){},"46da":function(e,t,s){"use strict";var a=s("566d"),n=s.n(a);n.a},"510f":function(e,t,s){},5144:function(e,t,s){},"566d":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"app-title"},[e._v("Wechat messager vue component demo")]),s("WeChatPanel")],1)},i=[],r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wechat-panel"},[s("h4",{staticClass:"wechat-panel--title"},[e._v(e._s(e.title))]),s("div",{staticClass:"wechat-panel--content",attrs:{id:"panelContent"}},[e._l(e.messages,(function(e){return s("WeChatMessageBridge",{key:e.id,attrs:{message:e}})})),e.emojis.length>0?s("div",{staticClass:"emoji-rain--container",style:e.emojiContainerStyle},e._l(e.emojis,(function(t,a){return s("span",{key:a,staticClass:"emoji-rain--emoji",style:e.getEmojiStyle(),on:{animationend:e.onAnimationEnd}},[e._v(e._s(t))])})),0):e._e()],2),s("div",{staticClass:"wechat-panel--footer"},[s("Button",{nativeOn:{click:function(t){return e.onFooterClick({type:"addMessage",data:{content:"生日快乐",type:"normal"}})}}},[e._v("生日快乐")]),s("Button",{nativeOn:{click:function(t){return e.onFooterClick({type:"addMessage",data:{title:"Learn Vue",desc:"how to use vue?",type:"link",url:"example.com"}})}}},[e._v("链接信息")]),s("Button",{nativeOn:{click:function(t){return e.onFooterClick({type:"addMessage",data:{type:"image",thumbnail:"//cdn.devdocs.io/assets/sprites/docs@2x-cdcc6bcba322c1a0ccc60722f8ad8e37ea4fc4a4c2701736d9f283ac876d89b1.png",image:"//cdn.devdocs.io/assets/sprites/docs@2x-cdcc6bcba322c1a0ccc60722f8ad8e37ea4fc4a4c2701736d9f283ac876d89b1.png"}})}}},[e._v("图片信息")]),s("Button",{nativeOn:{click:function(t){return e.onFooterClick({type:"addMessage",data:{type:"envelope",role:"system",takeBy:"枫叶",envelopeId:123}})}}},[e._v("红包被抢信息")])],1)])},o=[],c=(s("8e6e"),s("ac6a"),s("456d"),s("75fc")),l=s("bd86"),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("WeChatMessage",{staticClass:"message",class:{"message-system":e.isSystemMessage},attrs:{message:e.message}},[e.isSystemMessage?[s("template",{slot:"messagePrefix"},[e._v(e._s(""))]),s("SystemMessage",{attrs:{message:e.message}}),s("template",{slot:"messagePostfix"},[e._v(e._s(""))])]:["link"===e.message.type?s("LinkMessage",{attrs:{message:e.message},nativeOn:{click:function(t){return e.clickOnLink(e.message)}}}):e._e(),"vote"===e.message.type?s("VoteMessage",{attrs:{message:e.message}}):e._e(),"image"===e.message.type?s("ImageMessage",{attrs:{message:e.message}}):e._e()]],2)},m=[],f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"message-block",class:{"message-block--sender":"sender"===e.message.role}},[s("div",{staticClass:"message-wrapper"},[s("div",{staticClass:"message-prefix"},[e._t("messagePrefix",["loading"===e.message.status?s("Loading"):"failed"===e.message.status?s("span",{staticClass:"message-prefix--failed-mark",on:{click:e.onFailedClick}},[e._v("!")]):e._e()])],2),s("div",{staticClass:"message-item",class:{"message-item-link":e.isLink(e.message.content)}},[e._t("default",[e._v("\n                "+e._s(e.message.content)+"\n            ")])],2)]),s("div",{staticClass:"message-postfix"},[e._t("messagePostfix",[s("a",{attrs:{href:"#"}},[e.message.author.thumbnail?s("img",{attrs:{src:e.message.author.thumbnail}}):[e._v("\n                    "+e._s(e.message.author.name.substring(0,1))+"\n                ")]],2)])],2)])},d=[],p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("svg",{attrs:{width:"100%",height:"100%",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"}},[s("g",{attrs:{transform:"rotate(0 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"-0.8333333333333334s",repeatCount:"indefinite"}})])]),s("g",{attrs:{transform:"rotate(60 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"-0.6666666666666666s",repeatCount:"indefinite"}})])]),s("g",{attrs:{transform:"rotate(120 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"-0.5s",repeatCount:"indefinite"}})])]),s("g",{attrs:{transform:"rotate(180 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"-0.3333333333333333s",repeatCount:"indefinite"}})])]),s("g",{attrs:{transform:"rotate(240 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"-0.16666666666666666s",repeatCount:"indefinite"}})])]),s("g",{attrs:{transform:"rotate(300 50 50)"}},[s("rect",{attrs:{x:"47",y:"24",rx:"9.4",ry:"4.8",width:"6",height:"12",fill:"#28292f"}},[s("animate",{attrs:{attributeName:"opacity",values:"1;0",keyTimes:"0;1",dur:"1s",begin:"0s",repeatCount:"indefinite"}})])])])},g=[],h={},v=h,y=s("2877"),b=Object(y["a"])(v,p,g,!1,null,null,null),_=b.exports,C=function(e){return!!e&&/^(https?:)?(\/\/)?\w+\.\w+$/.test(e)},j={props:{message:{type:Object,default:function(){}}},components:{Loading:_},methods:{isLink:C,onFailedClick:function(){this.message.status="loading"}}},w=j,O=(s("ef83"),Object(y["a"])(w,f,d,!1,null,"53dd240c",null)),x=O.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"link-message"},[s("div",{staticClass:"link-message--title"},[e._v(e._s(e.message.title))]),s("div",{staticClass:"link-message--desc-wrap"},[s("div",{staticClass:"link-message--desc"},[e._v(e._s(e.message.desc))]),e.message.thumbnail?s("img",{staticClass:"link-message--thumb",attrs:{src:e.message.thumbnail}}):e._e()])])},M=[],P={props:{message:{type:Object,default:function(){}}}},S=P,E=(s("b7f2"),Object(y["a"])(S,k,M,!1,null,"557f80a2",null)),T=E.exports,B=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"vote-message"},[s("div",{staticClass:"vote-message--title"},[e._v(e._s(e.message.title))]),s("div",{staticClass:"vote-message--desc"},[e._v(e._s(e.message.desc))]),s("div",{staticClass:"vote-message--btns"},[s("Button",{nativeOn:{click:function(t){e.message.upvote+=1}}},[e._v("\n                ↑ "),e.message.upvote>0?s("span",[e._v(e._s(e.message.upvote))]):e._e()]),s("Button",{nativeOn:{click:function(t){e.message.downvote+=1}}},[e._v("\n                ↓ "),e.message.downvote>0?s("span",[e._v(e._s(e.message.downvote))]):e._e()])],1)])},R=[],$=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("button",{staticClass:"btn"},[e._t("default")],2)},L=[],A={},N=A,F=(s("a810"),Object(y["a"])(N,$,L,!1,null,"452fa650",null)),W=F.exports,D={props:{message:{type:Object,default:function(){}}},components:{Button:W}},I=D,V=(s("bca8"),Object(y["a"])(I,B,R,!1,null,"72129bf4",null)),q=V.exports,z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"image-message"},[s("img",{staticClass:"image-message--thumb",attrs:{src:e.message.thumbnail},on:{click:function(t){e.visible=!0}}}),e.visible?s("div",{staticClass:"image-message--viewer",style:e.viewerStyle,on:{click:function(t){e.visible=!1}}},[s("img",{attrs:{src:e.message.image}})]):e._e()])},J=[],H={props:{message:{type:Object,default:function(){}}},computed:{viewerStyle:function(){var e=this.panelRect;return{left:"".concat(e.left,"px"),width:"".concat(e.width,"px"),top:"".concat(e.top,"px"),height:"".concat(e.height,"px"),lineHeight:"".concat(e.height,"px")}}},data:function(){return{panelRect:{left:0,width:0,top:0,height:0},visible:!1}},mounted:function(){var e=document.body.querySelector("#panelContent");this.panelRect=e.getBoundingClientRect()}},U=H,Y=(s("46da"),Object(y["a"])(U,z,J,!1,null,"9193e764",null)),G=Y.exports,K=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"system-message"},["envelope"===e.message.type?s("div",{staticClass:"message-envelope"},[e._v("\n        "+e._s(e.message.takeBy)+" 领取了你的 "),s("a",{attrs:{href:"#"+e.message.envelopeId}},[e._v("红包")])]):e._e()])},Q=[],X={props:{message:{type:Object,default:function(){}}}},Z=X,ee=(s("0115"),Object(y["a"])(Z,K,Q,!1,null,"764cf08f",null)),te=ee.exports,se={components:{WeChatMessage:x,LinkMessage:T,VoteMessage:q,ImageMessage:G,SystemMessage:te},props:{message:{type:Object,default:function(){}}},computed:{isSystemMessage:function(){return"system"===this.message.role}},methods:{clickOnLink:function(e){alert(e.url)}}},ae=se,ne=(s("ff1f"),Object(y["a"])(ae,u,m,!1,null,"139b4cca",null)),ie=ne.exports,re=(s("6c7b"),{"生日快乐":"🎂"}),oe={data:function(){return{endCount:0,emojiTotal:10,emojis:[],emojiContainerRect:{top:0,left:0,right:0,bottom:0,width:0,height:0}}},computed:{emojiContainerStyle:function(){var e=this.emojiContainerRect,t=e.left,s=e.width,a=e.top,n=e.height;return{left:"".concat(t,"px"),width:"".concat(s,"px"),top:"".concat(a,"px"),height:"".concat(n,"px")}}},methods:{onAnimationEnd:function(){this.endCount+=1,this.endCount>=this.emojiTotal&&(this.emojis=[])},getEmojiStyle:function(){return{left:"".concat(Math.random()*this.emojiContainerRect.width,"px")}},showEmojiRain:function(){var e=this.messages.filter((function(e){return"read"!==e.status})).map((function(e){return re[(e.content||"").trim()]})).filter((function(e){return e})).pop();e&&(this.emojis=new Array(this.emojiTotal).fill(e))}},mounted:function(){var e=document.body.querySelector("#panelContent");this.emojiContainerRect=e.getBoundingClientRect(),this.showEmojiRain()},watch:{messages:function(){this.showEmojiRain()}}};function ce(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function le(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?ce(s,!0).forEach((function(t){Object(l["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):ce(s).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var ue=[{id:1,content:"test1",role:"sender",type:"normal",author:{name:"枫叶"}},{id:2,content:"google.com",role:"sender",type:"normal",status:"loading",author:{name:"枫叶",hasNewVideo:!0}},{id:3,title:"NO TITLE",desc:"test",url:"http://example.com",thumbnail:"//cdn.devdocs.io/assets/sprites/docs@2x-cdcc6bcba322c1a0ccc60722f8ad8e37ea4fc4a4c2701736d9f283ac876d89b1.png",role:"recevier",type:"link",status:"failed",author:{name:"叶枫"}},{id:4,title:"Upvote Me",desc:"This behaviour is only supported within the context of Styled Components",upvote:0,downvote:0,role:"recevier",type:"vote",author:{name:"叶枫"}}],me={mixins:[oe],data:function(){return{title:"枫叶",messages:ue}},components:{WeChatMessageBridge:ie,Button:W},methods:{onFooterClick:function(e){var t=e.type,s=e.data;switch(t){case"addMessage":this.lazyAddMessages(le({id:Date.now()},s,{role:s.role?s.role:Math.random()>.5?"sender":"recevier",author:{name:"枫叶"}}));break;default:break}}},created:function(){this.lazyAddMessages=function(){var e,t=0,s=[],a=this;return function(n){var i=Date.now();Array.isArray?s=s.concat(n):s.push(n),t=i,clearTimeout(e),e=setTimeout((function(){i===t&&(a.messages=[].concat(Object(c["a"])(a.messages.map((function(e){return le({},e,{status:e.status?e.status:"read"})}))),Object(c["a"])(s)),s=[])}),300)}}.bind(this)()}},fe=me,de=(s("0481"),Object(y["a"])(fe,r,o,!1,null,null,null)),pe=de.exports,ge={name:"app",components:{WeChatPanel:pe}},he=ge,ve=(s("034f"),Object(y["a"])(he,n,i,!1,null,null,null)),ye=ve.exports;a["a"].config.productionTip=!1,new a["a"]({render:function(e){return e(ye)}}).$mount("#app")},"64a9":function(e,t,s){},a810:function(e,t,s){"use strict";var a=s("1e20"),n=s.n(a);n.a},b7f2:function(e,t,s){"use strict";var a=s("510f"),n=s.n(a);n.a},bca8:function(e,t,s){"use strict";var a=s("cd71"),n=s.n(a);n.a},cd71:function(e,t,s){},ef83:function(e,t,s){"use strict";var a=s("384a"),n=s.n(a);n.a},ff1f:function(e,t,s){"use strict";var a=s("5144"),n=s.n(a);n.a}});
//# sourceMappingURL=app.474d9f24.js.map